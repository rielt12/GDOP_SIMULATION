function [y]=GPS(r1,r2,r3,r4,R1,R2,R3,R4)
y_i=[0;0;0;0];
E1=R1-sqrt((r1(1,1)-y_i(1,1))^2+(r1(2,1)-y_i(2,1))^2+(r1(3,1)-y_i(3,1))^2)+r1(4,1)-y_i(4,1);
E2=R2-sqrt((r2(1,1)-y_i(1,1))^2+(r2(2,1)-y_i(2,1))^2+(r2(3,1)-y_i(3,1))^2)+r2(4,1)-y_i(4,1);
E3=R3-sqrt((r3(1,1)-y_i(1,1))^2+(r3(2,1)-y_i(2,1))^2+(r3(3,1)-y_i(3,1))^2)+r3(4,1)-y_i(4,1);
E4=R4-sqrt((r4(1,1)-y_i(1,1))^2+(r4(2,1)-y_i(2,1))^2+(r4(3,1)-y_i(3,1))^2)+r4(4,1)-y_i(4,1);

rho_1=sqrt((r1(1,1)-y_i(1,1))^2+(r1(2,1)-y_i(2,1))^2+(r1(3,1)-y_i(3,1))^2);
rho_2=sqrt((r2(1,1)-y_i(1,1))^2+(r2(2,1)-y_i(2,1))^2+(r2(3,1)-y_i(3,1))^2);
rho_3=sqrt((r3(1,1)-y_i(1,1))^2+(r3(2,1)-y_i(2,1))^2+(r3(3,1)-y_i(3,1))^2);
rho_4=sqrt((r4(1,1)-y_i(1,1))^2+(r4(2,1)-y_i(2,1))^2+(r4(3,1)-y_i(3,1))^2);


A=[(r1(1,1)-y_i(1,1))/-rho_1,(r1(2,1)-y_i(2,1))/-rho_1,(r1(3,1)-y_i(3,1))/-rho_1,1;
   (r2(1,1)-y_i(1,1))/-rho_2,(r2(2,1)-y_i(2,1))/-rho_2,(r2(3,1)-y_i(3,1))/-rho_2,1;
   (r3(1,1)-y_i(1,1))/-rho_3,(r3(2,1)-y_i(2,1))/-rho_3,(r3(3,1)-y_i(3,1))/-rho_3,1;
   (r4(1,1)-y_i(1,1))/-rho_4,(r4(2,1)-y_i(2,1))/-rho_4,(r4(3,1)-y_i(3,1))/-rho_4,1;];


E=[E1;E2;E3;E4];

i=0;
while (abs(norm(E))>0.000000001)
 i=i+1;
  %delta_y=inv(A)*E;
  %delta_y = pinv(A'*A)*A'*E
  %delta_y = lsqr((A'*A),A'*E)
  delta_y = lschol(A'*A,A'*E);

  y_i=y_i+delta_y;

E1=R1-sqrt((r1(1,1)-y_i(1,1))^2+(r1(2,1)-y_i(2,1))^2+(r1(3,1)-y_i(3,1))^2)+r1(4,1)-y_i(4,1);
E2=R2-sqrt((r2(1,1)-y_i(1,1))^2+(r2(2,1)-y_i(2,1))^2+(r2(3,1)-y_i(3,1))^2)+r2(4,1)-y_i(4,1);
E3=R3-sqrt((r3(1,1)-y_i(1,1))^2+(r3(2,1)-y_i(2,1))^2+(r3(3,1)-y_i(3,1))^2)+r3(4,1)-y_i(4,1);
E4=R4-sqrt((r4(1,1)-y_i(1,1))^2+(r4(2,1)-y_i(2,1))^2+(r4(3,1)-y_i(3,1))^2)+r4(4,1)-y_i(4,1);



rho_1=sqrt((r1(1,1)-y_i(1,1))^2+(r1(2,1)-y_i(2,1))^2+(r1(3,1)-y_i(3,1))^2);
rho_2=sqrt((r2(1,1)-y_i(1,1))^2+(r2(2,1)-y_i(2,1))^2+(r2(3,1)-y_i(3,1))^2);
rho_3=sqrt((r3(1,1)-y_i(1,1))^2+(r3(2,1)-y_i(2,1))^2+(r3(3,1)-y_i(3,1))^2);
rho_4=sqrt((r4(1,1)-y_i(1,1))^2+(r4(2,1)-y_i(2,1))^2+(r4(3,1)-y_i(3,1))^2);


A=[(r1(1,1)-y_i(1,1))/-rho_1,(r1(2,1)-y_i(2,1))/-rho_1,(r1(3,1)-y_i(3,1))/-rho_1,1;
   (r2(1,1)-y_i(1,1))/-rho_2,(r2(2,1)-y_i(2,1))/-rho_2,(r2(3,1)-y_i(3,1))/-rho_2,1;
   (r3(1,1)-y_i(1,1))/-rho_3,(r3(2,1)-y_i(2,1))/-rho_3,(r3(3,1)-y_i(3,1))/-rho_3,1;
   (r4(1,1)-y_i(1,1))/-rho_4,(r4(2,1)-y_i(2,1))/-rho_4,(r4(3,1)-y_i(3,1))/-rho_4,1;];


E=[E1;E2;E3;E4];
end

y=y_i;

end



